name: Verificar Secrets

on:
  workflow_dispatch: # Executado manualmente

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Verificando secrets
        run: |
          REQUIRED_SECRETS=(
            SSH_PRIVATE_KEY
            SSH_USER
            SSH_HOST
            DEPLOY_PATH
          )

          MISSING=0

          for SECRET_NAME in "${REQUIRED_SECRETS[@]}"; do
            VALUE="${{ secrets[SECRET_NAME] }}"
            if [ -z "$VALUE" ]; then
              echo "::error::‚ùå Secret '$SECRET_NAME' est√° vazia ou n√£o foi definida."
              MISSING=1
            else
              echo "‚úÖ Secret '$SECRET_NAME' est√° presente."
            fi
          done

          if [ "$MISSING" -ne 0 ]; then
            echo "::error::‚ùå Existem secrets ausentes. Corrija antes de continuar."
            exit 1
          fi

          echo "üéâ Todas as secrets est√£o presentes!"
